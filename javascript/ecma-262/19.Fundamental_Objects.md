# 19 基本对象

## 19.1 Object对象

### 19.1.1 Object构造函数

Object构造函数:

- 固有对象%Object%
- 全局对象Object的初始值
- 被当做构造函数调用时创建一个新的普通对象
- 在作为函数而不是构造函数调用时会执行类型转换
- 被设计为可子类化。它可以用作类定义的extends字句的值

#### 19.1.1.1 Object([value])

使用可选参数值调用Object函数时，将执行以下步骤：

1. 如果NewTarget既不是undefined, 也不是活跃函数
    - 返回OrdinaryCreateFromConstructor(newTarget, "%ObjectPrototype%")
2. 如果value是null, undefined或未传入，返回ObjectCreate(%ObejctPrototype%)
3. 返回ToObject(value)

Object构造函数的length属性为1

#### 19.1.2.1 Object.assign(target, ...sources)

assign函数用来从一个或多个源对象复制可枚举的自身属性到目标对象上。当assign函数被调用时，步骤如下：

1. 设to为ToObject(target)
2. 如果只有一个参数，返回to
3. 设sources为从第二个参数开始的参数列表
4. 对于sources中的每个元素nextSource, 按升序
    - 如果nextSource既不是undefined, 也不是null
        + 设from为ToObject(nextSource)
        + 设keys为from.[[OwnPropertyKeys]]()
        + 对于keys中的每一个元素nextKey
            - 设desc为from.[[GetOwnProperty]](nextKey)
            - 如果desc不是undefined且desc.[[Enumerable]]为true
                + 设propValue为Get(from, nextKey)
                + Set(to, nextKey, propValue, true)

#### 19.1.2.2 Object.create(O, Properties)

create函数使用特定的原型创建一个新对象。当create函数调用时，执行下面的步骤：

1. 如果O不是对象类型或者Null, 抛出类型错误异常
2. 设obj为ObjectCreate(O)
3. 如果Properties不是undefined
    + 返回ObjectDefineProperties(obj, Properties)
4. 返回obj

#### 19.1.2.3 Object.defineProperties(O, Properties)

defineProperties函数用来添加对象自身属性或者更新已经存在属性的attribute。当defineProperties函数调用时，步骤如下：

1. 返回ObjectDefineProperties(O, Properties)

##### 19.1.2.3.1 运行时语义：ObjectDefineProperties(O, Properties)

带有参数O和Properties的抽象操作ObjectDefinedProperties，步骤如下

1. 如果O不是对象类型，抛出类型错误异常
2. 设props为ToObject(Properties)
3. 设keys为props.[[OwnPropertyKeys]]()
4. 设descriptors为新的空列表
5. 遍历keys中的每个元素nextKey
    + 设propDesc为props.[[GetOwnProperty]](nextkey)
    + 如果propDesc不是undefined, 且propsDesc.[[Enumerable]]为true
        - 设descObj为Get(props, nextKey)
        - 设desc为ToPropertyDescriptor(descObj)
        - 把[nextKey, desc]添加到descriptors尾部
6. 遍历descriptors的每个元素pair
    - 设P为pair第一个元素
    - 设desc为pair的第二个元素
    - 执行DefinePropertyOrThrow(O, P, desc)
7. 返回O

#### 19.1.2.4 Object.defineProperty(O, P, Attributes)

defineProperty函数给对象用来添加一个自身属性或更新一个已经存在的属性。执行步骤如下

1. 如果O的类型不是Object，抛出类型错误异常
2. 设key为ToPropertyKey(P)
3. 设desc为ToPropertyDescriptor(Attributes)
4. 执行DefinedPropertyOrThrow(O, Key, desc)
5. 返回O

